--- Diagnostic Start ---
File exists: True
TF Version: 2.20.0
Loading: D:\STUDY PROJECT\tomato-ai-project\models\disease_vit_model.h5

[Test 1] Loading with compile=False...
FAIL: TypeError: too many positional arguments
TRACEBACK:
Traceback (most recent call last):
  File "D:\STUDY PROJECT\tomato-ai-project\debug_vit.py", line 15, in debug_load
    model = tf.keras.models.load_model(model_path, compile=False)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\saving\saving_api.py", line 196, in load_model
    return legacy_h5_format.load_model_from_hdf5(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\legacy_h5_format.py", line 137, in load_model_from_hdf5
    model = saving_utils.model_from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\saving_utils.py", line 83, in model_from_config
    return serialization.deserialize_keras_object(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\serialization.py", line 488, in deserialize_keras_object
    deserialized_obj = cls.from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\model.py", line 694, in from_config
    return functional_from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\functional.py", line 577, in functional_from_config
    process_node(layer, node_data)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\functional.py", line 507, in process_node
    layer(*args, **kwargs)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\inspect.py", line 3177, in bind
    return self._bind(args, kwargs)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\inspect.py", line 3098, in _bind
    raise TypeError('too many positional arguments') from None
TypeError: too many positional arguments


[Test 2] Loading with full compilation...
FAIL: TypeError: too many positional arguments
TRACEBACK:
Traceback (most recent call last):
  File "D:\STUDY PROJECT\tomato-ai-project\debug_vit.py", line 24, in debug_load
    model = tf.keras.models.load_model(model_path)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\saving\saving_api.py", line 196, in load_model
    return legacy_h5_format.load_model_from_hdf5(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\legacy_h5_format.py", line 137, in load_model_from_hdf5
    model = saving_utils.model_from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\saving_utils.py", line 83, in model_from_config
    return serialization.deserialize_keras_object(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\legacy\saving\serialization.py", line 488, in deserialize_keras_object
    deserialized_obj = cls.from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\model.py", line 694, in from_config
    return functional_from_config(
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\functional.py", line 577, in functional_from_config
    process_node(layer, node_data)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\models\functional.py", line 507, in process_node
    layer(*args, **kwargs)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\inspect.py", line 3177, in bind
    return self._bind(args, kwargs)
  File "C:\Users\samue\AppData\Local\Programs\Python\Python310\lib\inspect.py", line 3098, in _bind
    raise TypeError('too many positional arguments') from None
TypeError: too many positional arguments

--- Diagnostic End ---
